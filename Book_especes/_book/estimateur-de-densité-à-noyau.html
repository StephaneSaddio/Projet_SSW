<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapitre 3 Estimateur de densité à noyau | Rapport du projet de M1</title>
  <meta name="description" content="Chapitre 3 Estimateur de densité à noyau | Rapport du projet de M1" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapitre 3 Estimateur de densité à noyau | Rapport du projet de M1" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapitre 3 Estimateur de densité à noyau | Rapport du projet de M1" />
  
  
  

<meta name="author" content="Wiam Chaoui" />
<meta name="author" content="Sophie Manuel" />
<meta name="author" content="Stéphane Sadio" />


<meta name="date" content="2021-01-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="méthodes-non-paramétriques.html"/>
<link rel="next" href="applications.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#motivation"><i class="fa fa-check"></i><b>1.1</b> Motivation</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#problématique"><i class="fa fa-check"></i><b>1.2</b> Problématique</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="méthodes-non-paramétriques.html"><a href="méthodes-non-paramétriques.html"><i class="fa fa-check"></i><b>2</b> Méthodes non-paramétriques</a><ul>
<li class="chapter" data-level="2.1" data-path="méthodes-non-paramétriques.html"><a href="méthodes-non-paramétriques.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="méthodes-non-paramétriques.html"><a href="méthodes-non-paramétriques.html#estimateurs-par-projection"><i class="fa fa-check"></i><b>2.2</b> Estimateurs par projection</a></li>
<li class="chapter" data-level="2.3" data-path="méthodes-non-paramétriques.html"><a href="méthodes-non-paramétriques.html#estimateurs-à-noyau-de-densité"><i class="fa fa-check"></i><b>2.3</b> Estimateurs à noyau de densité</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="estimateur-de-densité-à-noyau.html"><a href="estimateur-de-densité-à-noyau.html"><i class="fa fa-check"></i><b>3</b> Estimateur de densité à noyau</a><ul>
<li class="chapter" data-level="3.1" data-path="estimateur-de-densité-à-noyau.html"><a href="estimateur-de-densité-à-noyau.html#risque-quadratique-ponctuel-des-estimateurs-à-noyau-sur-les-classe-des-espaces-de-hölder"><i class="fa fa-check"></i><b>3.1</b> Risque quadratique ponctuel des estimateurs à noyau sur les classe des espaces de Hölder</a><ul>
<li class="chapter" data-level="3.1.1" data-path="estimateur-de-densité-à-noyau.html"><a href="estimateur-de-densité-à-noyau.html#majoration-du-biais-et-de-la-variance"><i class="fa fa-check"></i><b>3.1.1</b> Majoration du biais et de la variance</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="estimateur-de-densité-à-noyau.html"><a href="estimateur-de-densité-à-noyau.html#méthodes-adaptatives"><i class="fa fa-check"></i><b>3.2</b> Méthodes adaptatives</a><ul>
<li class="chapter" data-level="3.2.1" data-path="estimateur-de-densité-à-noyau.html"><a href="estimateur-de-densité-à-noyau.html#choix-du-noyau"><i class="fa fa-check"></i><b>3.2.1</b> Choix du noyau</a></li>
<li class="chapter" data-level="3.2.2" data-path="estimateur-de-densité-à-noyau.html"><a href="estimateur-de-densité-à-noyau.html#choix-de-la-fenêtre"><i class="fa fa-check"></i><b>3.2.2</b> Choix de la fenêtre</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i><b>4</b> Applications</a><ul>
<li class="chapter" data-level="4.1" data-path="applications.html"><a href="applications.html#fonction-dens"><i class="fa fa-check"></i><b>4.1</b> Fonction dens</a></li>
<li class="chapter" data-level="4.2" data-path="applications.html"><a href="applications.html#applications-aux-données-du-vivant"><i class="fa fa-check"></i><b>4.2</b> Applications aux données du vivant</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>5</b> Conclusion</a></li>
<li class="chapter" data-level="6" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>6</b> References</a></li>
<li class="chapter" data-level="" data-path="references-1.html"><a href="references-1.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Rapport du projet de M1</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="estimateur-de-densité-à-noyau" class="section level1">
<h1><span class="header-section-number">Chapitre 3</span> Estimateur de densité à noyau</h1>
<p>Dans un premier temps, nous cherchons à évaluer l’estimateur à noyau de densité. Pour cela nous allons utiliser la fonction de risque associée.</p>
<div id="risque-quadratique-ponctuel-des-estimateurs-à-noyau-sur-les-classe-des-espaces-de-hölder" class="section level2">
<h2><span class="header-section-number">3.1</span> Risque quadratique ponctuel des estimateurs à noyau sur les classe des espaces de Hölder</h2>
Cette partie a été inspirée par le livre <em>Introduction à la statistique nonparamétrique</em> par Gabriel Turinici.
Nous nous intéressons au risque quadratique ponctuel de <span class="math inline">\(\hat{f}_n\)</span>, définit par :<br />
étant donné <span class="math inline">\(x_0 \in \mathbb{R}\)</span>
<span class="math display">\[
R(\hat {f}_n, f) = \mathbb{E}[|\hat {f}_n(x_0) - f(x_0)|^2]
\]</span>

<p>Rappelons la décomposition “biais-variance” du risque quadratique :
<span class="math display">\[
\mathbb{E}[|\hat {f}_n(x_0) - f(x_0)|^2] = (\mathbb{E}[\hat {f}_n(x_0)] - f(x_0))^2 + \mathbb{V}[\hat {f}_n(x_0)]
\]</span></p>
<div id="majoration-du-biais-et-de-la-variance" class="section level3">
<h3><span class="header-section-number">3.1.1</span> Majoration du biais et de la variance</h3>
<p>Dans cette section, nous allons nous intéresser au compromis biais-variance afin de minimiser le risque quadratique.
Nous introduirons après quelques définitions deux propositions qui montrent que sous certaines hypothèses, on peut majorer le biais ainsi que la variance.</p>




Pour que la variance tende vers zéro, il faut que <span class="math inline">\(nh\)</span> tende vers l’infini. En particulier, à <span class="math inline">\(n\)</span> fixé, la variance est une fonction décroissante de <span class="math inline">\(h\)</span>. Il y a donc une valeur optimale de <span class="math inline">\(h\)</span> qui doit réaliser l’équilibre entre le biais au carré et la variance.<br />
On peut à présent donner un contrôle du risque quadratique par le théorème suivant.<br />



<p><strong>Exemple</strong>(Simulation numérique)<br />
Nous estimons la fonction densité d’une somme de deux variables gaussiennes ci-contre avec la méthode à noyau avec différentes fenêtres.
<span class="math display">\[
f(x)=\frac{1}{2}\frac{1}{\sqrt{2\pi}}(exp(-\frac{(x-2)^2}{2})+exp(-\frac{(x-6)^2}{2}))
\]</span>
On va en fait utiliser <code>ggplot</code> pour représenter l’estimateur à noyau. La fonction qui permet de dessiner l’estimateur à noyau est <code>geom_density</code>. Le paramètre représentant le fenêtre h rappelle <code>bw</code> (comme bandwidth en Anglais).</p>
<p><img src="Projet_M1_Chaoui_Manuel_Sadio_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>

</div>
</div>
<div id="méthodes-adaptatives" class="section level2">
<h2><span class="header-section-number">3.2</span> Méthodes adaptatives</h2>
<p> On introduit précédemment la notion de l’estimation de la densité qui dépend d’un paramètre de lissage <span class="math inline">\(h\)</span>. Soit <span class="math inline">\((\hat{f_h})_{h\in \mathcal H}\)</span> une famille des estimateurs de la fonction densité <span class="math inline">\(f\)</span> que que l’on cherchons cherche à estimer.
Une question s’impose : comment peut-on construire un estimateur à risque optimal à partir de cette famille en tenant en considération les observations ? 
Dans la théorie adaptative f est toujours supposée appartenir à une classe fonctionnelle. Cette classe n’est pas connu à priori mais supposé appartenir à une famille de classes fonctionnelles{<span class="math inline">\(\mathcal{F_{\alpha}},\alpha \in\mathcal{A}\)</span>} où <span class="math inline">\(\mathcal{A}\)</span> est un ensemble des paramètres de nuisance. ( ref : Sur l’estimation adaptative d’une densité multivariée sous l’hypothèse de la structure d’indépendance-Approche minimax adaptative).</p>
<p> Dans cette partie, afin de répondre à la question posée auparavant, nous allons discuter du choix du noyau en premier lieu. Ensuite, nous introduirons deux méthodes pour le choix du paramètre de lissage <span class="math inline">\(h\)</span>.</p>
<div id="choix-du-noyau" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Choix du noyau</h3>
<p> Avant de présenter le critère de choix du noyau nous allons introduire quelques outils mathématiques qui simplifient l’écriture du critère.<br />
Tout d’abord, nous avons besoin du risque quadratique <span class="math inline">\(\mathcal R\)</span> aussi appelé l’erreur quadratique moyenne (<strong>M</strong>ean <strong>S</strong>quared <strong>E</strong>rror en anglais). Dans cette partie nous allons noter <span class="math inline">\(MSE\)</span> le risque quadratique pour des questions pratiques.</p>
<p><span class="math display">\[
\begin{aligned}
MSE &amp;= \mathcal R = \mathbb E \left[ \{  \hat f_n(x)-f(x) \} \right] \\
&amp;=\mathbb V \left[ \hat f_n(x) \right] + Biais^2 \left[ \hat f_n(x) \right] \\
&amp;= MSE(x ; n, h, K, f).
\end{aligned}
\]</span>
comme nous l’avons montré précédemment. @ref{#holder}</p>




<p>L’approximation de l’erreur quadratique (<strong>A</strong>verage of <strong>M</strong>ean <strong>S</strong>quared <strong>E</strong>rror en anglais) est donnée par l’équation suivante :<br />
<span class="math display">\[
AMSE(x)= \frac1{nh} f(x) \int_{\mathbb R}K(t)^2 dt + \left(\frac12h^2f&#39;&#39;(x)\int_{\mathbb R} t^2K(t) dt \right)^2.
\]</span>
Elle a été calculée à partir de la variance approchée et du biais approché.</p>
<p>L’erreur quadratique moyenne intégrée (<strong>M</strong>ean <strong>I</strong>ntregrated <strong>S</strong>quared <strong>E</strong>rror en anglais) est une mesure théorique communément utilisée pour évaluer la différence entre <span class="math inline">\(f\)</span> et <span class="math inline">\(\hat f_n\)</span>. Pour l’évaluer on utilise l’erreur quadratique moyenne qu’on intègre sur le support <span class="math inline">\(\mathbb R\)</span> de l’estimateur.
<span class="math display">\[
\begin{aligned}
MISE(n,h,K,f) &amp;= \int_{\mathbb R}MSE(x;n,h,K,f)dx\\
&amp;= \int_{\mathbb R} \mathbb V\left[ \hat f_n(x) \right]  dx+ \int_{\mathbb R} Biais^2 \left[ \hat f_n(x) \right]dx
\end{aligned}
\]</span></p>
<p>De la même façon que nous l’avons fait avec l’erreur quadratique moyenne, nous allons calculer l’expression approchée de l’erreur quadratique moyenne (<strong>A</strong>verage of <strong>M</strong>ean <strong>I</strong>ntegrated <strong>S</strong>quared <strong>E</strong>rror en anglais).</p>
<p><span class="math display">\[
\begin{aligned}
AMISE(x)&amp;= \frac1{nh} \int_{\mathbb R}f(x)dx \int_{\mathbb R}K(t)^2 dt + \frac14h^4 \int_{\mathbb R}f&#39;&#39;(x)dx ~~\left(\int_{\mathbb R} t^2K(t) dt \right)^2\\
&amp;= \frac1{nh} \int_{\mathbb R}K(t)^2 dt 
+ \frac14h^4 \int_{\mathbb R}f&#39;&#39;(x)dx ~~\left(\int_{\mathbb R} t^2K(t) dt \right)^2\\
&amp;= \frac1{nh} \int_{\mathbb R}K(t)^2 dt 
+ \frac14h^4 ~ \mathbb V (K)^2 \int_{\mathbb R}f&#39;&#39;(x)dx 
\end{aligned}
\]</span></p>
<p> à présent que nous avons défini les outils nécessaires au choix du noyau, nous allons pouvoir présenter un critère de choix pour les noyaux continus symétriques. Afin de mesurer l’efficacité des noyaux, nous utilisons une mesure qui calcule le rapport du critère <span class="math inline">\(AMISE\)</span> de deux noyaux.
<span class="math display">\[
eff(K_1,K_2) = \frac{AMISE(K_1)}{AMISE(K_2)}.
\]</span>
Supposons que <span class="math inline">\(K_1\)</span> est le noyau d’Epanechnikov, il est souvent utilisé comme référence par rapport aux autres noyaux continus. Après quelques calculs, on obtient que l’efficacité d’un noyau K par rapport à celui d’Epanechnikov est donnée par
<span class="math display">\[
eff(K) = \frac{3}{5\times \int_{\mathbb R}K(t)^2 dt\sqrt{5 \times\int_{\mathbb R}t^2K(t) dt} } \leq1.
\]</span>
Voici un tableau récapitulatif de l’efficacité de plusieurs noyaux continus symétriques.</p>
<table>
<caption>(#tab:ker_tab)Efficacité des noyaux continus symétriques</caption>
<thead>
<tr class="header">
<th align="left">Noyau</th>
<th align="right">Efficacite</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Epanechnikov</td>
<td align="right">1.000</td>
</tr>
<tr class="even">
<td align="left">Bigweight</td>
<td align="right">0.994</td>
</tr>
<tr class="odd">
<td align="left">Triangular</td>
<td align="right">0.986</td>
</tr>
<tr class="even">
<td align="left">Gaussien</td>
<td align="right">0.951</td>
</tr>
<tr class="odd">
<td align="left">Rectangulaire</td>
<td align="right">0.930</td>
</tr>
</tbody>
</table>
<table>
<caption><span id="tab:nice-tab">Table 3.1: </span>Here is a nice table!</caption>
<thead>
<tr class="header">
<th align="right">Sepal.Length</th>
<th align="right">Sepal.Width</th>
<th align="right">Petal.Length</th>
<th align="right">Petal.Width</th>
<th align="left">Species</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">5.1</td>
<td align="right">3.5</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">4.9</td>
<td align="right">3.0</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">4.7</td>
<td align="right">3.2</td>
<td align="right">1.3</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">4.6</td>
<td align="right">3.1</td>
<td align="right">1.5</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">5.0</td>
<td align="right">3.6</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">5.4</td>
<td align="right">3.9</td>
<td align="right">1.7</td>
<td align="right">0.4</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">4.6</td>
<td align="right">3.4</td>
<td align="right">1.4</td>
<td align="right">0.3</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">5.0</td>
<td align="right">3.4</td>
<td align="right">1.5</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">4.4</td>
<td align="right">2.9</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">4.9</td>
<td align="right">3.1</td>
<td align="right">1.5</td>
<td align="right">0.1</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">5.4</td>
<td align="right">3.7</td>
<td align="right">1.5</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">4.8</td>
<td align="right">3.4</td>
<td align="right">1.6</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">4.8</td>
<td align="right">3.0</td>
<td align="right">1.4</td>
<td align="right">0.1</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">4.3</td>
<td align="right">3.0</td>
<td align="right">1.1</td>
<td align="right">0.1</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">5.8</td>
<td align="right">4.0</td>
<td align="right">1.2</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">5.7</td>
<td align="right">4.4</td>
<td align="right">1.5</td>
<td align="right">0.4</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">5.4</td>
<td align="right">3.9</td>
<td align="right">1.3</td>
<td align="right">0.4</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">5.1</td>
<td align="right">3.5</td>
<td align="right">1.4</td>
<td align="right">0.3</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">5.7</td>
<td align="right">3.8</td>
<td align="right">1.7</td>
<td align="right">0.3</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">5.1</td>
<td align="right">3.8</td>
<td align="right">1.5</td>
<td align="right">0.3</td>
<td align="left">setosa</td>
</tr>
</tbody>
</table>

<div id="comment-choisir-les-paramètres-de-la-méthode" class="section level4">
<h4><span class="header-section-number">3.2.1.1</span> Comment choisir les paramètres de la méthode ?</h4>
<p>Dans la méthode d’estimation à noyau le choix du noyau n’est pas le plus important, le vrai enjeu de cette méthode est le choix de la fenêtre <span class="math inline">\(h\)</span> (<em>bandwidth</em>).
En effet, la fenêtre détermine l’influence des données dans l’estimation. Si <span class="math inline">\(h\)</span> est petit, l’effet local est important donc on aura beaucoup de bruit. Si <span class="math inline">\(h\)</span> est grand, on aura une estimation plus douce, plus lisse.</p>
<p>Nous pouvons constater l’influence du paramètre <span class="math inline">\(h\)</span> sur l’exemple suivant :</p>
<p>Nous avons simulé 500 variables suivant une loi de Weibull de paramètres (<span class="math inline">\(\alpha = 1.7\)</span>, <span class="math inline">\(\lambda=2\)</span>) représentées dans l’histogramme. La courbe en rouge est la fonction de densité de la loi de Weibull et la bleue est l’estimation avec la méthode des noyaux sur les variables simulées.</p>
<p><img src="Projet_M1_Chaoui_Manuel_Sadio_files/figure-html/unnamed-chunk-3-1.png" width="672" />
La fenêtre <span class="math inline">\(h\)</span> du second graphique est calculée automatiquement par la fonction <code>density</code>de R.</p>

</div>
</div>
<div id="choix-de-la-fenêtre" class="section level3">
<h3><span class="header-section-number">3.2.2</span> Choix de la fenêtre</h3>
<p>L’estimation de densité nécessite le choix de la fenêtre qu’on note h.En statistique non-paramétrique, ils existent plusieurs méthodes et critères de qualité pour le choix de la fenêtre.</p>
<p>On présente dans la suite deux méthodes :
 Méthode de validation croisée.
 Méthode de Goldenshluger-Lepski.</p>
<div id="choix-de-la-fenêtre-h-par-validation-croisée" class="section level4">
<h4><span class="header-section-number">3.2.2.1</span> Choix de la fenêtre <span class="math inline">\(h\)</span> par validation croisée</h4>
<p>Le choix de la fenêtre dans la section précédente est critiquable : comme on l’a mentionné, il dépend de la régularité la fonction <span class="math inline">\(f\)</span> qui est inconnue dans notre cas. On peut donc essayer d’estimer cette fenêtre idéale par un estimateur <span class="math inline">\(\hat{h}\)</span>. De façon à souligner la dépendance à la fonction, on va noter <span class="math inline">\(\hat{f}_{n,h}\)</span> l’estimateur associé à un choix de fenêtre <span class="math inline">\(h\)</span>. L’estimateur final sera <span class="math inline">\(\hat{f}_{n,\hat{h}}\)</span>, une fois le choix de <span class="math inline">\(\hat{h}\)</span> fait.</p>
<p>On cherche à minimiser en <span class="math inline">\(h\)</span> le risque quadratique pour la distance <span class="math inline">\(L_2\)</span> :
<span class="math display">\[
\begin{aligned}
R(\hat {f}_{n,h})&amp;=\mathbb{E}[\begin{Vmatrix}\hat {f}_{n,h}-f\end{Vmatrix}_2^2]\\        
&amp;= \mathbb{E}[\begin{Vmatrix}\hat {f}_{n,h}\end{Vmatrix}_2^2] -2~\mathbb{E}[\int \hat {f}_{n,h}(x)f(x)dx] +\begin{Vmatrix}f\end{Vmatrix}_2^2
\end{aligned}
\]</span></p>
<p>Or la fonction <span class="math inline">\(f\)</span> étant inconnue, ce risque n’est pas calculable à partir des données. On cherche donc à estimer ce risque en utilisant uniquement les données. Remarquons que minimiser en <span class="math inline">\(h\)</span> la quantité <span class="math inline">\(R(\hat {f}_{n,h}, f)\)</span> est équivalent à minimiser en <span class="math inline">\(h\)</span> la quantité <span class="math inline">\(R(\hat {f}_{n,h}, f)-\begin{Vmatrix}f\end{Vmatrix}_2^2\)</span>. On va en fait remplacer la minimisation de la quantité inconnue <span class="math inline">\(R(\hat {f}_{n,h}, f)-\begin{Vmatrix}f\end{Vmatrix}_2^2\)</span> par la minimisation d’un estimateur <span class="math inline">\(\hat {R}(h)\)</span> de cette quantité. Plus précisément on va chercher un estimateur sans biais de cette expression:</p>
<p><span class="math display">\[
\mathbb{E}[\begin{Vmatrix}\hat {f}_{n,h}\end{Vmatrix}_2^2] -2~\mathbb{E}[\int \hat {f}_{n,h}(x)f(x)dx]
\]</span></p>
Le premier terme admet <span class="math inline">\(\begin{Vmatrix}\hat {f}_{n,h}\end{Vmatrix}_2^2\)</span> comme estimateur trivial (d’après la propriété des estimateurs sans biais : <span class="math inline">\(\mathbb{E}[\hat {\beta}]=\beta\)</span>).
Il reste à trouver un estimateur sans biais du second terme.

<p>Finalement, l’estimateur sans biais de <span class="math inline">\(R(\hat{f}_{n,h}, f)-\begin{Vmatrix}{f}\end{Vmatrix}_2^2\)</span> est donné par:</p>
<p><span class="math display">\[
\hat{R}(h)=\begin{Vmatrix}\hat{f}_{n,h}\end{Vmatrix}_2^2-\frac{2}{n(n-1)}\sum_{i=1}\sum_{j=1,j\ne i}\frac{1}{h}K(\frac{X_i-X_j}{h})
\]</span></p>
<p>On définit alors</p>
<p><span class="math display">\[
\hat{h} = arg\ \underset{h\in H}{min}\hat{R}(h)
\]</span></p>
<p>Si ce minimum est atteint. On cherche une fenêtre parmi une grille finie de valeurs, grille qu’on a notée <span class="math inline">\(H\)</span> dans la formule ci-dessus.<br />
L’estimateur <span class="math inline">\(\hat{f}_{n,\hat{h}}\)</span> a de bonnes propriétés pratiques et de consistance.</p>
<p>La validation croisée est une méthode très générale mais nous l’utilisons ici pour le choix la fenêtre <span class="math inline">\(h\)</span> optimale.</p>
<p>Voici un exemple avec validation croisée.
<img src="Projet_M1_Chaoui_Manuel_Sadio_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="méthodes-non-paramétriques.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="applications.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Projet_M1_Chaoui_Manuel_Sadio.pdf", "Projet_M1_Chaoui_Manuel_Sadio.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
